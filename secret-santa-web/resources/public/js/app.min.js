function date(a,b){var c=this;c.date=a,c.available=null!=b?b:!0}var app=angular.module("secretSanta",["ngRoute","ngResource"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/login",{templateUrl:"login.html",controller:"loginController",controllerAs:"login",name:"Login",path:"#/login",includeInNav:!1}).when("/preferences/:email?",{templateUrl:"preferences.html",controller:"preferencesController",controllerAs:"preferences",name:"Preferences",path:"#/preferences",includeInNav:!0})}]).factory("preferences",["$resource",function(a){return a("/preferences")}]).factory("dates",["$resource",function(a){return a("/event/:id/dates")}]).factory("venues",["$resource",function(a){return a("/event/:id/venues")}]).factory("authentication",["$resource",function(a){return a("/authentication")}]).config(["$httpProvider",function(a){a.interceptors.push(["$q",function(a){return{request:function(a){return $("#busy").show(),$(".hide-on-busy").hide(),$(".ajax-success").hide(),$(".ajax-failure").hide(),a},requestError:function(b){return $("#busy").hide(),$(".hide-on-busy").show(),$(".ajax-failure").show(),a.reject(b)},response:function(a){return $("#busy").hide(),$(".hide-on-busy").show(),$(".ajax-success").show(),a},responseError:function(b){return $("#busy").hide(),$(".hide-on-busy").show(),$(".ajax-failure").show(),a.reject(b)}}}])}]),app.controller("appController",["$scope","$route","$location",function(a,b,c){var d=this;d.routes=[],d.routeIsActive=function(a){return a.regexp.test(c.path())},angular.forEach(b.routes,function(a,b){1==a.includeInNav&&d.routes.push(a)}),d.test=function(){console.log(d.routes)}}]),app.controller("preferencesController",["$scope","$routeParams","$rootScope","preferences","dates","venues",function(a,b,c,d,e,f){var g=this,h=1;g.userEmail=null==b.email?c.email:b.email,c.email=g.userEmail,g.availableVenues=[],g.availableDates=[],f.query({id:h},function(a){g.availableVenues=a}),e.query({id:h},function(a){g.availableDates=a}),g.venue=null,g.formatDate=function(a){return a.date.format("Do MMMM YYYY")},g.savePreferences=function(){for(var a=[],b=0;b<g.availableDates.length;b++){var c=g.availableDates[b];a.push({date:c.date.utc().format("YYYY-MM-DD"),available:c.available})}d.save({email:g.userEmail,dates:a,venue:g.venue})}}]),app.controller("loginController",["authentication",function(a){var b=this;b.email=null,b.login=function(){}}]);